spring:
  application:
    name: chatbot-router-test

  datasource:
    url: jdbc:tc:mysql:8.0:///chatbot_router?TC_DAEMON=true
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
    username: test
    password: test

  data:
    redis:
      host: localhost
      port: 6379
      timeout: 3000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: false

# NapCat Configuration (Test Mock Values)
napcat:
  http:
    url: http://localhost:3000
    access-token: test-token
    timeout: 5000
  websocket:
    url: ws://localhost:3001
    access-token: test-token
    reconnect-interval: 5000

# JWT Configuration
jwt:
  secret: test-secret-key-for-testing-only-minimum-32-characters-required
  expiration: 86400000

# Sync Task Configuration (Test)
sync:
  task:
    cron: "0 0 */12 * * ?"  # Every 12 hours (less frequent for tests)
  retry:
    cron: "0 0 */2 * * ?"   # Every 2 hours
  default-rules:
    cron: "0 0 3 * * ?"     # Daily at 3 AM

# Resilience4j Retry Configuration (Test)
resilience4j:
  retry:
    instances:
      groupSync:
        max-attempts: 2  # Fewer attempts for faster tests
        wait-duration: 10s  # Shorter wait for tests
        exponential-backoff-multiplier: 2
        retry-exceptions:
          - java.io.IOException
          - java.net.SocketTimeoutException
        ignore-exceptions:
          - java.lang.IllegalArgumentException

# Caffeine Cache Configuration (Test)
caffeine:
  cache:
    system-config:
      expire-after-write: 60s  # Shorter expiry for tests
      maximum-size: 50
    group-sync:
      expire-after-write: 30s
      maximum-size: 100

# Logging
logging:
  level:
    root: INFO
    com.specqq.chatbot: DEBUG
